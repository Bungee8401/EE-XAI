--------------- 31.Jan 2025 ---------------------
TODO: No sequence, only list

1. find_thresh -> train_loader in threshold finder
    SOLVED

2. exit0 -> exit 2345
    right now only optimized at exit 0, test if imgs can still be classified right in exit 2,3,4,...
    TODO: SOLVED
        a) set exit 0 confidence to 0 -> disabling the first branch
        b) test again to see if the imgs can be classified correctly
    SOLVED

3. complexity of classifier and generator test
    e.g., cat, can exit at exit 0 but can not be classified correctly.
    question is, can this gen_cat img be classified correctly at exit 1,2,...?
        if yes, then the classifier's feature extraction ability for this class is not enough at first conv layer
            i.e., this hard class needs more layers in the classifier -> the classifier complexity is not enough
        if no until the last exit position
            the generator complexity is not enough
    SOLVED

4. gen_A - A = diff_A, add diff_A to other class imgs to see if they are influenced
    i should expect a yes in the result.
    e.g. diff of airplane add to truck, if truck then classified into airplane, jack pot!


5. 32*32 generator net -> 224*224 generator net
    SOLVED


------------------ 03.Feb 2025 ----------------------

generator224 gen_imgs can be classified correctly even in E1.
now problem is, how to fine tune the cls_loss, i.e. how to not overshoot:
TODO:
    1. crop edge of gen_imgs, test -> no, EE depends heavily on the edge patterns
            -> since the problem here is the EE, which is controlled by EE_loss
                try modifying the EE_loss to really find the EE features -> - now, by torch.mean(all exits confidence)
    2. torch.mean(five exits) give models that
        a) correct wrong labels
        b) maintain EE (1 later, 1 early)
        -> it is the patterns in the corner that 'force' imgs to exit earlier
        -> generative models may by nature cannot generate EE patterns
    3. take a look at heat maps
    4. wrong class into correct class is def. helpful in heatmaps
    5.
    6. get in bed early

------------------ 06.Feb 2025 ----------------------
build an early version of Grad CAM, not sure if everything is working properly, further test needed

below are reports for 07.Feb:

Brief summary:
1. Generator32 model complexity testing, issues found
2. build Generator224 model, gen_imgs now can be properly classified
3. use Generator224 to do Early Exit feature search, issues found
4. building grad-CAM to verify my guess

Details:
1. Generator32 :
    a) for easy class
        - exits early at E0
        - all classified correct as airplane
        - even can correct wrong classified imgs
    b) for hard class
        - cannot classify imgs correctly at E0
        - have to delay exit layer to make sure the classification is correct

    -> which means, the complexity of this generator is not enough for my needs.
       I upgrade the scale of the generator to let it generate 224*224 imgs for higher resolution

2. Generator224 :
    a) easy and hard class all perform well
        - gen_imgs can be classified correctly and exit the network early (mostly E0, hard class at E1)

    b) two examples below to demonstrate

        # 0 airplane, 100 epoch, original vs gen       ---- easy class, most at E0

        ----Test Exit Location: [[0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 3, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0], [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0]]
        Original Exit Location: [[1, 1, 1, 1, 0, 1, 1, 1, 2, 1, 1, 1, 4, 1, 2, 3, 1, 1, 1, 1, 4, 2, 0, 1, 1, 2, 1, 1, 1, 1, 0, 1, 0, 0, 1, 2, 0, 2, 0, 0, 0, 5, 0, 2, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 2, 0, 1, 1, 1, 0, 0, 0, 1, 2, 1, 0, 1, 1, 1, 2, 0, 1, 1, 3, 2, 0, 0, 2, 2, 1, 1, 0, 1, 0, 1, 2, 1, 0, 1, 0, 0, 1, 2, 0, 1, 0, 0, 3, 1, 0, 0, 0, 0, 1, 1, 0, 1, 2, 1, 0, 0, 3, 2, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 2, 1, 0, 2, 0, 1, 2, 1, 0, 0, 0, 0, 0, 2, 1, 0, 1, 1, 1, 4, 2, 0, 0, 0, 0, 2, 2, 2, 1, 2, 1, 1, 2, 0, 0, 2, 0, 1, 0, 1, 2, 2, 1, 0, 1, 1, 1, 0, 1, 2, 2, 1, 1, 0, 2, 1, 1, 3, 1, 0, 1, 0, 1, 2, 1, 2, 0, 1, 0, 1, 4, 1, 2, 2, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 2, 0, 1, 0, 0, 0, 0, 0, 2, 0, 2, 1, 2, 1, 1, 1, 0, 1, 2, 1, 0, 0, 0, 1, 1, 1, 1, 1, 2, 1, 0, 1, 0, 1], [1, 1, 0, 2, 1, 1, 0, 0, 0, 1, 1, 2, 2, 2, 1, 1, 0, 0, 2, 1, 1, 1, 1, 2, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 2, 2, 1, 0, 0, 2, 1, 2, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 2, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 2, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 2, 0, 0, 1, 1, 1, 0, 2, 2, 1, 0, 0, 0, 2, 1, 2, 1, 2, 2, 1, 1, 2, 0, 2, 1, 1, 1, 0, 1, 3, 1, 1, 1, 1, 3, 2, 0, 1, 2, 0, 0, 1, 0, 1, 1, 0, 1, 2, 0, 0, 2, 0, 1, 2, 1, 1, 0, 1, 0, 1, 1, 1, 1, 2, 2, 1, 1, 1, 3, 2, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 2, 1, 1, 2, 0, 1, 0, 1, 1, 1, 1, 2, 0, 0, 1, 0, 0, 2, 0, 0, 1, 1, 0, 3, 2, 1, 1, 1, 2, 0, 0, 1, 0, 2, 1, 1, 0, 3, 3, 1, 0, 1, 0, 1, 1, 3, 0, 0, 1, 1, 0, 1, 1, 1, 2, 2, 1, 1, 1, 0, 0, 1, 0, 1, 0, 2, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 5], [1, 1, 0, 0, 0, 1, 1, 2, 0, 1, 0, 3, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 2, 0, 1, 0, 2, 0, 2, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 2, 0, 0, 2, 0, 0, 0, 1, 1, 2, 1, 0, 2, 2, 1, 2, 0, 0, 0, 2, 2, 2, 0, 1, 2, 2, 2, 2, 3, 0, 1, 1, 2, 2, 1, 2, 0, 2, 2, 1, 0, 1, 1, 1, 0, 0, 1, 2, 1, 0, 0, 2, 1, 0, 5, 2, 1, 0, 1, 2, 1, 0, 2, 0, 0, 2, 1, 2, 0, 1, 0, 1, 1, 0, 1, 0, 0, 2, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 2, 2, 0, 1, 2, 2, 0, 1, 1, 2, 0, 0, 2, 5, 2, 0, 2, 2, 0, 0, 1, 2, 0, 1, 1, 1, 2, 1, 2, 2, 0, 1, 1, 1, 0, 0, 5, 1, 1, 1, 3, 0, 0, 0, 1, 1, 0, 2, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 4, 1, 0, 0, 0, 1, 0, 1, 0, 2, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 2, 1, 1, 0, 1, 1, 0, 1, 1, 0, 3, 1, 1, 0, 0, 0, 2, 2, 2, 1, 0, 2, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 2, 1, 0, 1], [1, 0, 2, 1, 0, 2, 0, 2, 1, 2, 0, 1, 0, 1, 2, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 2, 1, 1, 0, 1, 1, 1, 0, 1, 0, 2, 1, 1, 1, 2, 2, 0, 0, 1, 1, 1, 2, 0, 1, 2, 2, 0, 1, 2, 0, 1, 0, 2, 2, 1, 1, 0, 1, 1, 2, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 2, 0, 1, 1, 1, 0, 2, 1, 1, 1, 0, 1, 0, 0, 2, 1, 1, 2, 1, 0, 2, 0, 0, 1, 1, 2, 1, 0, 0, 0, 0, 0, 0, 2, 0, 1, 1, 2, 1, 2, 0, 1, 0, 0, 0, 2, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 4, 0, 1, 1, 1, 2, 0, 1, 0, 1, 2, 1, 2, 1, 2, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 2, 0, 1, 4, 1, 1, 2, 1, 0, 1, 2, 0, 1, 1, 0, 1, 2, 0, 4, 0, 0, 2, 0, 0, 2, 0, 0, 3, 3, 0, 0, 0, 1, 3, 1, 1, 1, 1, 0, 1, 1, 1, 0, 2, 2, 1, 0, 1, 2, 5, 1, 1, 0, 2, 1, 1, 0, 1, 0, 0, 1, 2, 0, 1]]
        early or late: [[1, 1, 1, 0, 2, 3, 1, 1, 0, 3, 1, 0, 2, 0, 0, 1, 0, 1, -1, 1, 1, -1, 0, 5, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 2, 1, 2, 0, 1, 0, -1, 0, 1, 2, 3, 2, 1, 1, 0, 0, 2, 1, 0, 2, 0, 1, 0, 0, 0, 1, 2, 0, 1, 1, 1, 1, 1, 0, 1, 0, 2, 2, 1, -1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, -1, 1, 0, 0, 1, 0, 1, 0, 0, 2, 1, 1, 2, 0, 0, 0, 2, 0, 1, 1, 2, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 2, 0, 1, 1, 1, 2, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 2, 0, 1, 2, 1, 0, 1, 2, 0, 1, 0, 2, 1, 0, -1, 0, 3, 1, 1, 0, 0, 2, 2, 1, 1, 0, 3, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 2, 2, 0, 0, 2, -1, 0, 1, 1, 2, 2, 0, -1, 1, -2, 0, 2, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 2, 0, 0, 2, 0, 1, 0, 0, 2, 1, 2, 0, 0, 0, 1, 2, 0, 1, 2, 0, 2, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1], [-1, 0, 1, 3, 0, -1, 1, 0, 2, 4, 1, 1, 0, 0, 0, 0, 0, 2, 1, 0, 0, 0, 1, 1, 1, 2, 0, 1, -1, 1, 2, 2, -1, 2, 2, 2, 1, 0, 1, 2, -1, 0, 0, 0, 0, 2, 1, 1, 1, 1, 1, 0, 0, 2, 0, -1, 2, 0, 0, 1, 0, 1, 2, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 2, 0, -1, 0, 0, 0, 0, 3, 0, 0, 2, 0, 2, 1, 2, 1, -1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 2, 2, 2, 2, 1, 1, 1, 1, 0, 1, 0, 1, -2, 1, 0, 0, 0, 1, 0, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, 2, 2, 0, 2, 1, 1, 2, 0, 1, -1, 2, 0, 1, 1, 0, 1, 2, 1, 1, 0, 1, -2, 1, 0, 0, 0, 2, 1, 2, 1, 1, 2, 2, 2, 1, 1, 1, 1, 2, -2, 1, 0, 0, 1, 1, 1, 2, 2, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 2, 2, -1, 0, 1, 2, 2, 1, 0, 0, 1, 5, 2, 0, 0, 1, 1, 1, 2, 2, 1, 0, 0, 0, 2, 2, 0, 0, 1, 0, 2, 1, 2, 1, 3, 2, 1, 0, 1, 0, 0, 1, 1, 0, -1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1], [2, 0, 1, 2, 1, 0, 0, 0, 0, 0, 2, 1, 0, 2, 2, 1, 1, 1, 1, 1, 0, 0, 1, 2, 4, 0, 1, 0, 2, 1, 0, 1, 2, 0, 2, 1, 0, 0, -1, 0, 0, 1, 1, 1, 1, 1, 0, 3, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 2, 1, 0, 2, 4, 0, 1, 1, 0, 1, 1, 1, 1, 2, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 2, 1, 1, 2, 1, 1, 0, 1, 1, 2, 2, 1, 1, 1, 0, 4, 0, 1, 1, 0, 0, 1, 1, -1, 0, 0, -1, 0, 0, 1, 1, 1, 0, 1, 0, -1, 1, 1, 2, 2, 2, 0, 0, 1, 0, 1, 1, 1, 1, 1, 2, 1, 1, 2, 0, 2, 0, 2, 1, -1, -2, 1, 0, 0, 1, 1, 1, 2, 2, 2, 0, 2, -1, 1, 0, 2, 4, 0, 1, 0, 0, 0, 1, 2, 2, 0, 0, 0, 1, 1, 1, -1, 1, -2, 4, 2, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 0, 1, 0, 1, 1, 0, 4, 1, 1, 3, 1, 2, 1, 0, 2, 2, 2, 1, 2, 0, 1, 3, 0, 1, 0, 2, 1, 0, 1, 1, 3, 1, 0, 0, 1, 0, 1, 1, 2, 0, -2, 0, 0, 0, 2, 2, 2, 0, 1], [1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 2, 0, 0, 2, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 2, 0, 3, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, -2, 1, 1, 0, 1, 1, 1, 0, 0, 0, 4, 0, 2, 0, 0, 5, 2, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 3, 1, 0, 1, 2, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 2, 1, 2, 0, 1, 1, 0, 1, 2, 1, 0, 1, 1, 0, 1, 0, -1, 1, 0, 1, 2, 0, 0, 2, 0, 1, 1, 1, 0, 1, 0, 2, 0, 1, 2, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 2, 0, 2, 3, 2, 1, 1, 0, 0, 0, 0, 1, 2, 1, 1, -3, -1, 1, 0, 0, 2, 5, 1, 0, 0, 2, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 2, 2, 1, 1, 2, 1, 2, 1, 0, 0, 2, 0, 0, 0, 1, 1, 4, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 2, 0, 1, 1, 1, 0, 2, 1, 1, -1, -1, 0, 3, 0, 5, 0, 3, 0, 1, 2, 2, 0, 0, 0, 0, 1, 1, 0]]

        negative count: 39 of 1000
        positive count: 597 of 1000
        maintain count: 364 of 1000

        # 3 cat, 200 epoch, original vs gen            ---- hard class, most at E1

        ----Test Exit Location: [[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0]]
        Original Exit Location: [[1, 1, 1, 2, 1, 2, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, 2, 1, 1, 1, 5, 2, 3, 3, 0, 1, 2, 2, 2, 2, 0, 2, 3, 1, 1, 2, 0, 1, 2, 1, 1, 1, 1, 2, 2, 4, 1, 2, 0, 3, 4, 2, 1, 2, 1, 2, 2, 0, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, 1, 1, 1, 2, 1, 2, 1, 3, 1, 0, 2, 3, 2, 3, 2, 2, 1, 1, 1, 1, 0, 1, 2, 4, 3, 1, 1, 2, 0, 1, 1, 1, 1, 0, 2, 0, 2, 0, 1, 2, 2, 1, 0, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, 1, 1, 2, 1, 2, 1, 2, 2, 1, 0, 1, 2, 0, 2, 1, 1, 2, 2, 2, 2, 1, 1, 3, 1, 3, 2, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 0, 1, 1, 0, 1, 1, 1, 0, 1, 2, 1, 2, 4, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 3, 1, 4, 2, 1, 5, 2, 1, 0, 3, 1, 1, 0, 2, 1, 1, 0, 3, 2, 2, 2, 1, 1, 1, 2, 1, 0, 2, 0, 1, 2, 2, 2, 1, 0, 1, 2, 0, 2, 2, 1, 3, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 5, 1, 1, 2, 1, 2, 2], [2, 2, 1, 3, 2, 2, 0, 1, 3, 0, 2, 2, 1, 1, 0, 1, 1, 2, 0, 1, 0, 2, 2, 0, 1, 1, 1, 1, 1, 2, 1, 2, 5, 1, 2, 1, 1, 2, 1, 1, 2, 1, 1, 0, 2, 1, 2, 0, 2, 1, 5, 2, 2, 1, 1, 1, 1, 1, 2, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 3, 1, 2, 2, 2, 2, 3, 1, 2, 2, 2, 2, 3, 1, 1, 2, 2, 3, 2, 2, 1, 1, 0, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 3, 1, 1, 2, 2, 2, 1, 3, 3, 1, 2, 1, 3, 2, 1, 1, 2, 1, 4, 1, 1, 2, 1, 1, 2, 1, 2, 1, 0, 1, 1, 2, 3, 1, 1, 2, 1, 0, 1, 4, 1, 2, 1, 1, 2, 1, 0, 2, 2, 1, 1, 2, 1, 0, 1, 2, 2, 2, 3, 1, 3, 2, 2, 2, 1, 2, 1, 5, 1, 1, 2, 2, 3, 1, 2, 1, 1, 1, 0, 1, 1, 2, 1, 2, 1, 1, 2, 5, 2, 1, 2, 1, 4, 2, 1, 2, 0, 1, 1, 4, 2, 1, 2, 3, 1, 1, 0, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, 1, 1, 3, 1, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1, 0, 1, 2, 1, 0, 3, 2, 1, 2, 3, 1], [1, 4, 3, 2, 5, 0, 1, 0, 2, 4, 2, 1, 2, 2, 1, 1, 2, 0, 3, 1, 0, 1, 1, 5, 1, 1, 1, 1, 1, 1, 2, 0, 4, 3, 3, 2, 1, 0, 1, 1, 1, 2, 2, 1, 2, 2, 1, 2, 1, 0, 2, 2, 2, 2, 1, 2, 1, 1, 0, 2, 2, 2, 1, 2, 1, 2, 0, 1, 0, 1, 1, 2, 2, 3, 5, 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 0, 1, 1, 1, 2, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 3, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 5, 1, 1, 3, 1, 1, 0, 5, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 3, 5, 2, 2, 1, 2, 1, 3, 1, 0, 1, 0, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 3, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 0, 2, 2, 1, 1, 2, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1, 3, 1, 2, 1, 0, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 0, 2, 0, 3, 1, 2, 1, 2, 2, 1, 1, 2, 2, 1, 1, 0, 2, 1, 3, 0, 1, 1, 3, 1, 1, 2, 2, 1, 1, 2, 1, 1, 5, 2, 1, 0, 3, 2], [1, 2, 5, 2, 3, 1, 1, 0, 1, 0, 1, 2, 2, 3, 1, 2, 1, 1, 1, 2, 1, 2, 0, 1, 1, 2, 0, 2, 1, 2, 1, 3, 0, 0, 1, 1, 2, 4, 2, 0, 2, 1, 1, 1, 2, 0, 3, 1, 0, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 2, 0, 1, 2, 2, 1, 5, 1, 0, 1, 1, 1, 2, 1, 1, 2, 3, 1, 3, 2, 1, 2, 5, 2, 1, 1, 4, 1, 1, 3, 2, 2, 1, 1, 4, 1, 2, 1, 0, 2, 1, 2, 2, 3, 2, 0, 3, 1, 2, 1, 2, 0, 1, 2, 2, 2, 2, 5, 2, 1, 1, 1, 4, 3, 3, 1, 2, 2, 1, 0, 2, 2, 1, 1, 0, 1, 2, 2, 0, 1, 0, 2, 2, 2, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 0, 2, 1, 2, 2, 2, 2, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 2, 3, 2, 2, 4, 0, 2, 4, 2, 0, 2, 2, 1, 1, 2, 4, 5, 2, 1, 1, 1, 2, 0, 1, 1, 1, 2, 2, 4, 2, 2, 2, 2, 2, 1, 5, 1, 1, 5, 3, 0, 2, 2, 2, 2, 1, 1, 1, 1, 2, 3]]

        early or late: [[1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 5, 2, 3, 3, 0, 1, 2, 2, 2, 2, 0, 2, 3, 1, 1, 2, 0, 1, 2, 1, 1, 1, 0, 2, 2, 4, 1, 2, 0, 3, 4, 2, -1, 2, 1, 2, 2, 0, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 1, 1, 0, 1, 2, 1, 2, 2, 2, 0, 1, 1, 1, 2, 1, 2, 1, 3, 1, 0, 2, 3, 2, 3, 2, 2, 1, 1, 1, 1, 0, 1, 2, 4, 3, 1, 1, 2, -1, 1, 1, 1, 1, 0, 2, 0, 2, 0, 1, 2, 2, 1, 0, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, 1, 1, 2, 1, 2, 1, 2, 2, 1, 0, 1, 2, 0, 2, 1, 1, 1, 2, 2, 2, 1, 1, 3, 1, 3, 2, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 0, 1, 1, 0, 0, 1, 1, 0, 1, 2, 1, 2, 4, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 3, 1, 4, 2, 1, 5, 2, 1, 0, 3, 0, 1, 0, 2, 1, 1, 0, 3, 2, 2, 2, 1, 1, 1, 2, 1, 0, 2, 0, 1, 2, 2, 2, 1, 0, 1, 2, 0, 2, 2, 1, 3, 1, 2, 1, 1, 2, 1, 0, 1, 1, 2, 2, 2, 5, 1, 1, 2, 1, 2, 2], [2, 2, 1, 3, 2, 2, 0, 1, 2, 0, 2, 2, 1, 1, 0, 1, 0, 2, 0, 1, 0, 2, 2, 0, 1, 1, 1, 1, 1, 2, 1, 1, 5, 1, 2, 1, 1, 2, 1, 1, 2, 1, 1, 0, 2, 1, 2, 0, 2, 1, 5, 2, 2, 1, 1, 1, 1, 1, 2, 1, 4, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 3, 1, 2, 2, 2, 2, 3, 1, 2, 2, 2, 2, 3, 1, 1, 2, 2, 3, 2, 2, 1, 1, -1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 3, 1, 0, 2, 2, 2, 1, 3, 3, 1, 2, 1, 3, 2, 1, 1, 2, 1, 4, 1, 1, 2, 1, 1, 2, 1, 2, 1, 0, 1, 0, 2, 3, 1, 1, 2, 1, 0, 1, 4, 1, 2, 1, 1, 2, 1, 0, 2, 2, 1, 1, 2, 1, 0, 1, 2, 2, 2, 3, 1, 3, 2, 2, 2, 1, 2, 1, 5, 1, 0, 2, 2, 3, 1, 2, 1, 0, 1, 0, 1, 1, 2, 1, 2, 1, 1, 2, 5, 2, 1, 2, 1, 4, 2, 1, 2, 0, 1, 1, 4, 2, 1, 2, 3, 1, 1, 0, 1, 2, 1, 1, 2, 1, 2, 2, 1, 0, 1, 1, 3, 1, 1, 1, 1, 1, 2, 1, 2, 3, 2, 1, 0, 1, 2, 1, 0, 3, 2, 1, 2, 3, 1], [1, 4, 3, 2, 5, 0, 1, 0, 2, 3, 2, 1, 2, 2, 1, 1, 1, 0, 3, 1, 0, 1, 1, 4, 1, 1, 1, 1, 1, 1, 2, 0, 4, 2, 3, 2, 1, 0, 1, 1, 1, 2, 2, 0, 2, 2, 1, 2, 1, 0, 2, 2, 2, 2, 1, 2, 1, 1, 0, 2, 2, 2, 1, 2, 1, 2, 0, 1, 0, 1, 0, 2, 2, 3, 4, 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 0, 1, 1, 1, 2, 1, 2, 1, 0, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 3, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 5, 1, 1, 3, 1, 1, 0, 5, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 3, 5, 2, 2, 1, 2, 1, 3, 1, 0, 0, 0, 1, 2, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 2, 2, 2, 2, 2, 1, 2, 3, 2, 2, 2, 2, 1, 2, 0, 2, 2, 2, 0, 2, 2, 1, 1, 2, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1, 3, 1, 2, 1, 0, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 0, 2, 0, 2, 0, 0, 1, 1, 2, 1, 1, 2, 2, 1, 1, 0, 2, 1, 3, 0, 1, 1, 3, 1, 1, 1, 2, 1, 1, 2, 1, 1, 5, 2, 1, 0, 3, 2], [1, 2, 5, 2, 3, 1, 1, 0, 1, 0, 1, 2, 2, 3, 1, 1, 0, 1, 1, 2, 1, 2, 0, 1, 1, 2, 0, 2, 0, 2, 1, 3, 0, -1, 1, 1, 2, 4, 2, 0, 2, 1, 1, 1, 2, 0, 3, 1, 0, 0, 1, 1, 1, 1, 0, 1, 3, 2, 2, 2, 0, 1, 2, 2, 1, 5, 1, 0, 1, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 2, 5, 2, 1, 1, 4, 0, 1, 3, 2, 2, 1, 1, 4, 1, 1, 1, 0, 2, 1, 2, 2, 3, 2, 0, 3, 1, 1, 1, 2, 0, 1, 2, 2, 2, 2, 5, 2, 1, 1, 1, 4, 2, 3, 1, 2, 2, 1, 0, 2, 2, 1, 1, -1, 1, 1, 2, 0, 1, 0, 2, 2, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 0, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 0, 2, 1, 2, 2, 2, 2, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 2, 3, 2, 2, 4, 0, 2, 4, 2, 0, 2, 2, 1, 1, 2, 4, 5, 2, 1, 1, 1, 2, 0, 1, 1, 1, 2, 2, 4, 2, 2, 2, 2, 2, 1, 5, 1, 1, 5, 3, 0, 2, 2, 2, 2, 1, 1, 1, 1, 1, 3]]
        negative count: 5 of 1000
        positive count: 884 of 1000
        maintain count: 111 of 1000

3. EE feature (edge pattern test)

    a) edge pattern relation with exit_loss parameter
        150~250 * exit_loss     - almost no edge pattern, also can only roughly maintain EE
        500 * exit_loss         - mostly at E0 and correctly classified

    b) cropping to test the patterns relation with EE
        - from 5 pixels, to 15 pixels (till patterns are cropped)
        - gen_imgs exit from E0 to E1/E2 (which is mostly the where original imgs exit

        -> clearly, they are related.
        -> use Grad CAM to verify if the edges are what the major contribution here

4. Grad CAM result

    a) Grad CAM is not finished, for now just a demonstrate toy
        - gradient channels are way more than 3 RGB channels

    b) for now, edgy pattern seems not sensitive to Grad CAM
        - furthur test needed